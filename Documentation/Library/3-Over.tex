\chapter{Übersicht von Ausspähtechniken}
\section{Übersichtsmatrix}
Folgende Matrix gibt eine Übersicht über die bekannten Ausspähtechniken und ihre Eigenschaften.
\begin{figure}[H]
\centering
\includegraphics[width=0.8\linewidth]{./Graphics/uebersichtsmatrix}
\caption[Übersichtsmatrix]{Übersichtsmatrix Ausspähtechniken}
\label{fig:uebersichtsmatrix}
\end{figure}
\newpage
\section{Erklärung der verschiedenen Techniken}
\subsection{Shouldersurfing}
Shouldersurfing ist eine einfache Art, wie man auf öffentlichen Plätzen sehr schnell an persönliche Daten kommt. Vor allem in der heutigen Zeit mit Smartphones ist die Technik sehr beliebt. Der Angreifer schaut dem Opfer über die Schulter, wenn dieses ein Passwort eintippt, Formular ausfüllt oder persönliche Daten anschaut. 

Die Gefahr für den Angreifer entdeckt zu werden ist jedoch sehr gross.

\subsubsection{Schutzmechanismen}
Wenn man sorgfältig mit seinen Daten umgeht und sich der Gefahr von Shouldersurfing bewusst ist, ist man sicher.


\subsection{Suchmaschinen}
Eine der beliebtesten, einfachsten und auch effektivsten Footprintings ist, das Ziel über Suchmaschinen zu suchen. Es handelt sich hier klar um ein passives Footprinting ohne Kontakt mit dem Ziel. Ein Suchservice wird "'missbraucht"', um an Daten des Ziels zu kommen. Als Beispiel für generelle Ziele kann Google gebraucht werden. Für Personen empfiehlt sich zum Beispiel Jasni.com oder 123people.com. 

Vor allem Google ist ein sehr mächtiges Tool, um viel über Ziele herauszufinden. Google versteht als Beispiel viel mehr als nur Schlüsselwörter. Mit Regular Expression ähnlichen Kommandos \footcite{googlehint}, kann man sich näher an sein Ziel tasten.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\linewidth]{./Graphics/GoogleSearch.png}
\caption{Such-Tricks - MP3 Suche über Google}
\label{fig:googleTricks}
\end{figure}

\subsubsection{Schutzmechanismen}
Mit einer robots.txt Datei \footcite{robotstxt} auf der eigenen Seite kann man definieren was von Suchmaschinen indexiert werden soll und was nicht. Auf Webseiten ausserhalb des Einflussbereiches sollte man auf die Preisgabe von sensiblen Informationen verzichten. Man kann auch nachprüfen, was man über sich selber findet, in dem man simpel nach sich sucht. Einige Suchmaschinen bieten auch einen regelmässigen Bericht über eigene Aktivitäten im Netz an \footcite{googleme}.


\subsection{Websites durchsuchen}
Noch simpler als Suchmaschinen zu benutzen ist, die Webseite des Ziels zu besuchen. Viele Personen oder Unternehmen gehen viel zu freizügig mit persönlichen Informationen um und riskieren so eine Grundlage, weiterführendes Ausspähen zu ermöglichen. 
Beispielsweise findet man oft E-Mail Adressen von Personen auf Webseiten, welche man für Suchanfragen über Foren, Sozialen Netzwerken oder Suchmaschinen benutzen kann. 
Mit dem Besuch der Webseite hat man jedoch Kontakt mit dem Ziel, d.h. die Chance, entdeckt zu werden, erhöht sich.  Um dies zu umgehen, kann man auch den Cache von Suchmaschinen verwenden. 

\subsubsection{Schutzmechanismen}
Auf privaten Webseiten sollte genau überlegt werden was man von sich preis gibt. Ein Kontaktformular ist besser als eine e-Mail Adresse. Jegliche Informationen sollten zuerst auf ihren Wert für andere überprüft werden. 

\subsection{DNS Entry und  Whois Lookup}
Jeder Domain Name im Internet muss bei einer Name Authority registriert werden. Name Authoritys verlangen üblicherweise weitere Informationen zum Inhaber der Domaine, z.B. Name und eine Kontakt e-Mail Adresse. Diese Informationen können sehr hilfreich sein für weiterführende Attacken. Über diese sogenannten Whois-Lookups (z.b. unter http://centralops.net/co abrufbar) können auch übergeordnete Autoritäten herausgesucht werden (z.B. welcher ISP der Host hinter der Domaine benutzt).

Viele Whois Lookup Webseiten haben ihre Funktionalität noch erweitert. Eine super Toolbox rund um DNS und MX Einträge findet man unter http://mxtoolbox.com/
\newpage
\subsubsection{Schutzmechanismen}
Anbieter für Internet Security wie z.B. WhoisGuard bieten Whois Privacy Protection Services an (Siehe Abbildung \ref{fig:RageBooter})
\begin{figure}[H]
\centering
\includegraphics[width=0.6\linewidth]{./Graphics/RageBooterWhoIs.png}
\caption[RageBooter Whois Entry]{WhoIs Eintrag von RageBooter.com}
\label{fig:RageBooter}
\end{figure}


\subsection{Foren durchsuchen}
Neben sozialen Netzwerken kann man viele Informationen über Foren erhalten. Wenn man schon einige Daten über das Ziel gefunden hat (z.B. Tätigkeiten, Vöorlieben, evtl. ein Name, am besten eine E-Mail Adresse) kann man in bekannten Foren, in welchen man Aktivität des Ziels vermutet weiter suchen. Mit etwas Glück findet man einer der bekannten Usernamen des Ziels und kann so sehr nahe an das Ziel herankommen, ohne die Möglichkeit entdeckt zu werden. Auch dies gilt noch als passives Footprinting, da das Ziel üblicherweise kein Zugriff auf das Forum hat und darum dort auch nichts Tracken/Überwachen kann.

\subsubsection{Schutzmechanismen}
Für jedes Forum sollte man ein anderer Benutzername und Passwort benutzen. Falls möglich sollte man verschiedene e-Mail Adressen für die Registrierung benutzen. Dies geht gut mit temporären E-Mail Diensten wie 10minutemail.com oder mailinator.com. Ein erwünschter Nebeneffekt sind die ausbleibenden Spam und/oder Werbe-Mails.

\subsection{Social Network}
Während Foren früher eine super Ressource waren, geht es heute viel einfacher über soziale Netzwerke Informationen aus erster Hand zu erhalten. In sozialen Netzwerken ist es viel einfacher das Ziel aufzuspüren, da es meistens mit dem richtigen Namen registriert ist. 
Jedoch haben sich viele soziale Netzwerke dem angenommen und starke Privatsphären Einstellungen vorgenommen. Die User sind auch sensibler geworden und geben nicht mehr viele persönliche Daten der Öffentlichkeit frei. 
Wenn man jedoch innerhalb des sozialen Netzwerkes auf "'aktives Footprinting"' übergeht und unter einem gefälschten Namen eine Freundschaftsanfrage versendet, können auch heute noch die meisten Netzwerke sehr gut für Footprinting verwendet und viele Informationen gewonnen werden. 

\subsubsection{Schutzmassnahmen}
Viele soziale Netzwerke verlangen den echten Namen. Am besten benützt man einen abgekürzten oder verfälschten Name. Die Privatsphäre Einstellungen sollten jedoch immer genau überprüft und möglichst restriktiv eingestellt werden. Der einzige sichere Schutz vor Footprinting ist, kein Account zu besitzen bzw. keine privaten und sensiblen Informationen darüber zu teilen.  

\subsection{Netzwerksniffing}
Die nächsten Techniken sind mehr auf die Technik ausgelegt. Netzwerksniffing ist eine simple Methode, an sehr viele Informationen zu gelangen, wenn man sich in logische Nähe zum Ziel bringen kann (vorzugsweise im gleichen Netzwerk). Heute ist immer noch sehr viel Traffic unverschlüsselt und kann durch Sniffingtools aufgeschnappt und verarbeitet werden. Zusätzlich sind viele Verschlüsselungsarten schon geknackt (als Beispiel sei hier PPTP erwähnt \footcite{pptpdead}) und können nach etwas Aufwand auch abgehört werden.

Diese Problem ist größer als man auf Anhieb denkt. Ein lokales Netzwerk abzuhören ist relativ einfach, da die Übertragung auf Glasfaserleitungen zwischen Firmengebäuden/Filialen\footcite{findcable} meist unverschlüsselt von statten geht  \footcite{hackcable}. 

\subsubsection{Schutzmechanismen}
Der einfachste Schutz gegen Netzwerksniffing ist, alle sensitive Traffic zu verschlüsseln. Dies ist nicht immer möglich. Darum zeigt folgende Liste verschiedene Methoden, um gegen Sniffing zu schützen:
\begin{itemize}
\item Verschlüsseltes VPN zwischen Gebäuden und Filialen
\item IP Adressen nur über autorisierte MAC-Adresse vergeben
\item Physikalische Sicherheit 
\item Keine Broadcast Netzwerk-Devices (z.B. HUB) benutzen
\item Proxy-ARP Detektoren (passiv oder aktiv) benutzen \footcite{arpspoof}
\end{itemize}



\subsection{Host Service Analysen (SYN Scan, Trace, Port Scan, Ping, Fingerprinting)}
Mit der Technik "Host Service Analysen" fasst dieses Dokument Port Scans und ähnliche Techniken zusammen. Bei der Technik wird versucht, möglichst viel über ein IT-System herauszufinden. Diese Informationen können als Grundlage einer anschliessenden Attacke dienen.  

Bevor man Portscans und dergleichen ausführt, muss man zuerst ein System haben, das verfügbar ist. Dafür benutzt man meist ein Ping. Wenn man nicht genau weiss, unter welcher IP der Host verfügbar ist, jedoch in welchem Subnetz er sich befindet macht man einen sogenannten "Ping Sweep". Das ist nichts anderes als jede verfügbare IP eines bestimmten Subnetzes zu pingen (In weiterführender Literatur kann mehr darüber nachgelesen werden\footcite{pingsweep}). 

Sobald man einen verfügbaren Host gefunden hat, bietet das Netzwerk viele Möglichkeiten, Informationen zu sammeln. Zum einen kann man mit einem Traceroute herausfinden, welchen Weg das Paket durchläuft. So kann man z.B. Firewalls finden die dazwischen installiert sind. 

Bei einem Port Scan verbindet man sich mit bestimmten (oder allen) Ports eines Systems. Je nach Reaktion des Ziels kann daraus abgeleitet werden ob der Port geöffnet ist oder nicht. Dies ist jedoch sehr offensichtlich und wird schnell erkannt. Eine "'elegantere"' Lösung für Port-Scans, sind sogenannte SYN Scans (werden auch Stealth Scans genannt). Diese Scans schicken auf TCP Level nur ein SYN packet ab und schauen ob ein SYN-Ack Paket zurück kommt (falls dies der Fall ist, akzeptiert der Host Verbindungen auf diesem Port). 

Um jetzt herauszufinden, was sich hinter dem Port verbirgt, sendet man ein Fingerprint Paket. D.h. Man Startet das vermutete Protokoll (z.B. bei dem Port 80 versucht man ein HTTP Get Packet zu schicken). Je nach Antwort kann man so relativ schnell herausfinden, welcher Prozess auf dem Port reagiert.

\subsubsection{Schutzmechanismen}
Der Schlüssel zur Mitigation ist die Detektion eines Port-Scans. Dies kann sehr einfach auf Firewalls geschehen. Zusätzlich gibt es spezialisierte Geräte (Stichwort Intrusion Detection System \footcite{idswiki}) die auffällige Traffic (z.B. Portscans) detektieren.

Sobald ein Portscan detektiert wurde, kann man meistens der Host auf der Firewall blockieren. Es empfiehlt sich grundsätzlich immer zu wissen, welche Ports gegenüber dem Internet verfügbar ist. 



\subsection{User Agent Grabbing}
Bei dem User Agent Grabbing wird ein ganz anderer Ansatz gefahren. Hier hat man kein bestimmtes Ziel, sondern eine Zielgruppe. Man ködert die Zielgruppe auf eine (fingierte oder gehackte)  Webseite und kann so sehr viel über den Host herausfinden (Siehe Abbildung \ref{fig:browserinfo}). Setzt man zusätzlich noch JavaScript und dergleichen ein, kann nahezu alles über den Host und auch den User herausgefunden werden. 
\begin{figure}[H]
\centering
\includegraphics[width=0.6\linewidth]{./Graphics/browserinfo.png}
\caption[Browserübersicht]{Auszug eines Chrome-Browsers (nicht vollständig)}
\label{fig:browserinfo}
\end{figure}

Die meisten Informationen werden aus Kompatibilitätsgründen vom Browser preisgegeben. Schutzmechanismen existieren hier keine. Der User sollte einfach vorsichtig sein beim Surfen.

\subsubsection{Schutzmechanismen}
Leider gibt es hierfür wenige Schutzmechanismen. Da der Browser gewissen Informationen aus Kompatibilitätsgründen mit der Webseite austauschen muss, kann der Angreifer automatisch Informationen herausfinden. Möglichkeiten sind nur, den User Agent zu ändern, z.B. bietet Chrome ein solches Feature an \footcite{uae}


\subsection{Vulnerability Scans und Penetration Tests}
Vulnerability Scans sind erweiterte Port Scans. Sie Scannen die Ports eines Hosts, und schicken anschliessend ein legitimes Package des erwarteten Protokolls (z.B. auf 80 ein HTTP GET /), um herauszufinden was für Software auf dem Port verfügbar ist. Je nach Antwort fragt der Vulnerability Scanner nach mehr Informationen (z.B. Informationen über den Webserver). Der Vulnerability Scanner vergleicht anschliessend die gesammelten Informationen mit einer Vulnerability Datenbank. (Ein Praktisches Beispiel und genauere Analysen sind unter dem Kapitel \ref{nessus} zu finden) 

Der Penetration Test geht etwas weiter als der Vulnerability Scan. Ein Penetration Test erhebt nicht nur Daten eines Systems, er versucht auch Lücken m System auszunützen und eine möglichst hohe Rechteeskalation zu erreichen. Ein Penetration Test ist sehr anspruchsvoll durchzuführen und ein grosses Know-How des auszuführenden Testers ist Voraussetzung, denn der Penetration Tester versucht, sich wie ein Hacker zu verhalten. 

\subsubsection{Schutzmechanismen}
Vulnerability Scans und Penetration Tests sollte man mithilfe eines Firewalls und eines IDS detektieren und der Angreifer vollkommen aussperren, z.B. indem man die IP auf dem Firewall blockt.


\subsection{Social Engineering}
Social Engineering ist ein Überbegriff, um die Prozesse und Personen eines Unternehmens zu missbrauchen, um an Daten zu kommen. Es gibt unzählige Wege dies zu erreichen. Dieses Dokument bezieht sich auf drei Wesentliche (Vertiefte Informationen sind in der Quellen ersichtlich \footcite{ooo}). Als vierte kann man Social Networks zählen, welche weiter oben beschrieben wurde.

\subsubsection{Phishing}
Die Idee hinter Phishing ist, möglichst viele Personen mit einer gefälschten E-Mail anzuschreiben und zu hoffen, dass ein Empfänger auf die gefälschte E-Mail hereinfällt. Diese Methode ist sehr beliebt im Bankensektor, um an Konten von Kunden eines Finanzinstitutes zu kommen. Der Angreifer sendet eine E-Mail an eine grosse Anzahl von E-Mail Adressen. Er gibt sich als Mitarbeiter des Opfers aus (z.B. einer Bank) und verlangt nach den Kundendaten, um etwas zu evaluieren (z.B. ein Erbe, die Sicherheitseinstellungen). Oft werden auch gefälschte Webseiten mitgesendet, damit das Ziel sich auf der Webseite einloggt und alle Daten für den Login in das Kundenkonto preisgibt. Diese Webseiten sind selten zusätzlich mit Viren infiziert, um zukünftige Tasteneingaben einfangen zu können (Keystokelogger).

\subsubsection{Nigeriam Scam}
Nigeriam Scam funktioniert sehr ähnlich wie Phishing, es sist nur etwas simpler. Der Attacker gibt sich als Freund oder Verwandter aus und beschreibt seine aktuelle Notsituation - natürlich alles frei erfunden - und bittet darum um etwas Geld.

\subsubsection{E-Mail Out of Office}
Etwas exotischer um Informationen über unternehmen zu sammeln ist, Out of Office Auto-Replys von Benutzern eines Unternehmens zu empfangen. Die Out of Office Replys haben meistens viele interessante Informationen über die Organisation. IT-Security Mitarbeiter konnten so schon die ganze Organisationsstruktur mit solchen Informationen nachbilden. 

\subsubsection{Schutzmechanismen}
Das Stichwort um sich gegen Social Engineering zu schützen heisst "'Awareness"'. Es ist wichtig den Benutzer zu schulen und auf Social Engineering Gefahren aufmerksam zu machen. 

\subsection{Spionage Applikationen}
Diese Methode lässt sich nicht in oberes Schema kategorisieren. Solche Applikationen sind weder Footprinting, Vulnerability Scans oder Penetration Tests. Man geht davon aus, dass man schon Zugriff auf den Computer oder das Smartphone des Opfers erlangt hat. Sobald dies der Fall, ist geht es darum, möglichst viele Daten zu erlangen. Dafür gibt es Spionage Applikationen. Spionage Applikationen können z.B. in Viren und Trojanern enthalten sein, oder auch legitim Installiert werden (mit oder ohne des Wissens des Ziels). Es ist illegal Applikationen, welche den User ausspionieren, ohne die Einverständnis des Users zu installieren. 




